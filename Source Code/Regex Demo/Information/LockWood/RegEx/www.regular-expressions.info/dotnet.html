<HTML>
<!-- Mirrored from www.regular-expressions.info/dotnet.html by HTTrack Website Copier/3.x [XR&CO'2002], Mon, 14 Nov 2005 11:48:07 GMT -->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Using Regular Expressions with .NET - C# and Visual Basic</TITLE>

<META NAME="Author" CONTENT="Jan Goyvaerts">
<META NAME="Description" CONTENT="Learn how to use the regular expression classes that are part of the Microsoft .NET (dot net) Framework, and can be readily used in any .NET programming language such as C# (C sharp) or Visual Basic.NET">
<META NAME="Keywords" CONTENT="">
<LINK REL=StyleSheet HREF="regex.css" TYPE="text/css">
</HEAD>
<BODY BGCOLOR=white TEXT=black>
<DIV CLASS=top><DIV CLASS=logo><IMG SRC="img/logo.gif" WIDTH=530 HEIGHT=100></DIV></DIV>
<DIV CLASS=btntop><A CLASS=btntop HREF="tutorial.html" TARGET="_top">&nbsp;Tutorial&nbsp;</A><A CLASS=btntop HREF="tools.html" TARGET="_top">&nbsp;Tools&nbsp;&amp;&nbsp;Languages&nbsp;</A><A CLASS=btntop HREF="examples.html" TARGET="_top">&nbsp;Examples&nbsp;</A><A CLASS=btntop HREF="books.html" TARGET="_top">&nbsp;Books&nbsp;&amp;&nbsp;Reference&nbsp;</A></DIV>
<DIV CLASS=bodytext>
<TABLE CLASS=topad> <TR><TD VALIGN=top><A HREF="http://www.regexbuddy.com/csharp.html" TARGET="_top"><IMG SRC="img/rxb48.gif" WIDTH=48 HEIGHT=48 ALT="RegexBuddy" BORDER=0></A></TD> <TD CLASS=topad><A HREF="http://www.regexbuddy.com/csharp.html" TARGET="_top">Easily use the power of regular expressions in your C# and VB.NET applications</A> with RegexBuddy.<BR> Create and analyze regex patterns with RegexBuddy's intuitive regex building blocks. Implement regexes in your applications with instant Perl code snippets. Just tell RegexBuddy what you want to achieve, and copy and paste the auto-generated C# or VB.NET code. <A HREF="http://www.regexbuddy.com/">Get your own copy of RegexBuddy now</A>.</TD> </TR></TABLE> <H1>Using Regular Expressions with The Microsoft .NET Framework</H1> <P>The Microsoft .NET Framework, which you can use with any .NET programming language such as C# (C sharp) or Visual Basic.NET, has solid support for regular expressions. The documentation of the regular expression classes is very poor, however. Read on to learn how to use regular expressions in your .NET applications. In the text below, I will use VB.NET syntax to explain the various classes. After the text, you will find a complete application written in C# to illustrate how to use regular expressions in great detail. I recommed that you download the source code, read the source code and play with the application. That will give you a clear idea how to use regexes in your own applications.</P> <H2>System.Text.RegularExpressions Overview (Using VB.NET Syntax)</H2> <P>The regex classes are located in the namespace System.Text.RegularExpressions. To make them available, place <TT CLASS=code>Imports System.Text.RegularExpressions</TT> at the start of your source code.</P> <P>The <TT CLASS=code>Regex</TT> class is the one you use to compile a regular expression. For efficiency, regular expressions are compiled into an internal format. If you plan to use the same regular expression repeatedly, construct a <TT CLASS=code>Regex</TT> object as follows: <TT CLASS=code>Dim RegexObj as Regex = New Regex("regularexpression")</TT>. You can then call <TT CLASS=code>RegexObj.IsMatch("subject")</TT> to check whether the regular expression matches the subject string. The <TT CLASS=code>Regex</TT> allows an optional second parameter of type <TT CLASS=code>RegexOptions</TT>. You could specify <TT CLASS=code>RegexOptions.IgnoreCase</TT> as the final parameter to make the regex case insensitive. Other options are <TT CLASS=code>RegexOptions.Singleline</TT> which causes the <A HREF="dot.html" TARGET="_top">dot to match newlines</A> and <TT CLASS=code>RegexOptions.Multiline</TT> which causes the <A HREF="anchors.html" TARGET="_top">caret and dollar to match at embedded newlines</A> in the subject string.</P> <P>Call <TT CLASS=code>RegexObj.Replace("subject", "replacement")</TT> to perform a search-and-replace using the regex on the subject string, replacing all matches with the replacement string. In the replacement string, you can use <TT CLASS=code>$&</TT> to insert the entire regex match into the replacement text. You can use <TT CLASS=code>$1, $2, $3, etc...</TT> to insert the text matched between <A HREF="brackets.html" TARGET="_top">capturing parentheses</A> into the replacement text. Use <TT CLASS=code>$$</TT> to insert a single dollar sign into the replacement text. To replace with the first backreference immediately followed by the digit 9, use <TT>${1}9</TT>. If you type $19, and there are less than 19 backreferences, the <TT>$19</TT> will be interpreted as literal text, and appear in the result string as such. To insert the text from a <A HREF="named.html" TARGET="_top">named capturing group</A>, use <TT>${name}</TT>. Improper use of the $ sign may produce an undesirable result string, but will never cause an exception to be raised.</P> <P><TT CLASS=code>RegexObj.Split("Subject")</TT> splits the subject string along regex matches, returning an array of strings. The array contains the text between the regex matches. If the regex contains <A HREF="brackets.html" TARGET="_top">capturing parentheses</A>, the text matched by them is also included in the array. If you want the entire regex matches to be included in the array, simply place round brackets around the entire regular expression when instantiating <TT CLASS=code>RegexObj</TT>.</P> <P>The <TT CLASS=code>Regex</TT> class also contains several static methods that allow you to use regular expressions without instantiating a <TT CLASS=code>Regex</TT> object. This reduces the amount of code you have to write, and is appropriate if the same regular expression is used only once or reused seldomly. Note that member overloading is used a lot in the <TT CLASS=code>Regex</TT> class. All the static methods have the same names (but different parameter lists) as other non-static methods.</P> <P><TT CLASS=code>Regex.IsMatch("subject", "regex")</TT> checks if the regular expression matches the subject string. <TT CLASS=code>Regex.Replace("subject", "regex", "replacement")</TT> performs a search-and-replace. <TT CLASS=code>Regex.Split("subject", "regex")</TT> splits the subject string into an array of strings as described above. All these methods accept an optional additional parameter of type <TT CLASS=code>RegexOptions</TT>, like the constructor.</P> <H2>The System.Text.RegularExpressions.Match Class</H2> <P>If you want more information about the regex match, call <TT CLASS=code>Regex.Match()</TT> to construct a <TT CLASS=code>Match</TT> object. If you instantiated a <TT CLASS=code>Regex</TT> object, use <TT CLASS=code>Dim MatchObj as Match = RegexObj.Match("subject")</TT>. If not, use the static version: <TT CLASS=code>Dim MatchObj as Match = Regex.Match("subject", "regex")</TT>.</P> <P>Either way, you will get an object of class <TT CLASS=code>Match</TT> that holds the details about the first regex match in the subject string. <TT CLASS=code>MatchObj.Success</TT> indicates if there actually was a match. If so, use <TT CLASS=code>MatchObj.Value</TT> to get the contents of the match, <TT CLASS=code>MatchObj.Length</TT> for the length of the match, and <TT CLASS=code>MatchObj.Index</TT> for the start of the match in the subject string. The start of the match is zero-based, so it effectively counts the number of characters in the subject string to the left of the match.</P> <P>If the regular expression contains <A HREF="brackets.html" TARGET="_top">capturing parentheses</A>, use the <TT CLASS=code>MatchObj.Groups</TT> collection. <TT CLASS=code>MatchObj.Groups.Count</TT> indicates the number of capturing parentheses. The count includes the zeroth group, which is the entire regex match. <TT CLASS=code>MatchObj.Groups(3).Value</TT> gets the text matched by the third pair of round brackets. <TT CLASS=code>MatchObj.Groups(3).Length</TT> and <TT CLASS=code>MatchObj.Groups(3).Index</TT> get the length of the text matched by the group and its index in the subject string, relative to the start of the subject string. <TT CLASS=code>MatchObj.Groups("name")</TT> gets the details of the <A HREF="named.html" TARGET="_top">named group</A> "name". </P> <P>To find the next match of the regular expression in the same subject string, call <TT CLASS=code>MatchObj.NextMatch()</TT> which returns a new <TT CLASS=code>Match</TT> object containing the results for the second match attempt. You can continue calling <TT CLASS=code>MatchObj.NextMatch()</TT> until <TT CLASS=code>MatchObj.Success</TT> is False.</P> <P>Note that after calling <TT CLASS=code>RegexObj.Match()</TT>, the resulting <TT CLASS=code>Match</TT> object is independent from <TT CLASS=code>RegexObj</TT>. This means you can work with several <TT CLASS=code>Match</TT> objects created by the same <TT CLASS=code>Regex</TT> object simultaneously.</P> <H2>Regular Expressions, Literal Strings and Backslashes</H2> <P>In literal C# strings, as well as in C++ and many other .NET languages, the backslash is an escape character. The literal string <TT CLASS=code>"\\"</TT> is a single backslash. In regular expressions, the backslash is also an escape character. The regular expression <TT CLASS=regex>\\</TT> matches a single backslash. This regular expression as a C# string, becomes <TT CLASS=code>"\\\\"</TT>. That's right: 4 backslashes to match a single one.</P> <P>The regex <TT CLASS=regex>\w</TT> matches a word character. As a C# string, this is written as <TT CLASS=code>"\\w"</TT>.</P> <P>To make your code more readable, you should use C# verbatim strings. In a verbatim string, a backslash is an ordinary character. This allows you to write the regular expression in your C# code as you would write it a tool like <A HREF="regexbuddy.html" TARGET="_top">RegexBuddy</A> or <A HREF="powergrep.html" TARGET="_top">PowerGREP</A>, or as the user would type it into your application. The regex to match a backlash is written as <TT CLASS=code>@"\\"</TT> when using C# verbatim strings. The backslash is still an escape character in the regular expression, so you still need to double it. But doubling is better than quadrupling. To match a word character, use the verbatim string <TT CLASS=code>@"\w"</TT>.</P> <H2>.NET Framework Demo Application using Regular Expressions (C# Syntax)</H2> <P>To really get to grips with the regex support of the Microsoft .NET Framework, I recommend that you study the demo application I created. It is written in C#. The demo is fairly simple, so you should understand the source code even if you do not use C# yourself. The demo code has lots of comments that clearly indicate what my code does, why I coded it that way, and which other options you have. The demo code also catches all exceptions that may be thrown by the various methods, something I did not explain above.</P> <P>The demo application covers every aspect of the System.Text.RegularExpressions package. You can use it to learn how to use the package, and to quickly test regular expressions while coding.</P> <P><A HREF="dotnetexample.html" TARGET="_top">Read the source code in your web browser</A></P> <P><A HREF="http://www.regular-expressions.info/download/csharpregexdemo.zip">Download the demo application and source code</A></P> <DIV CLASS=copyright> <P CLASS=copyright>Page URL: <A HREF="dotnet.html" TARGET="_top">http://www.Regular-Expressions.info/dotnet.html</A><BR> Last Updated: 24 June 2004<BR> Copyright &copy; 2003-2005 Jan Goyvaerts. All rights reserved.</P> </DIV> </DIV> <DIV CLASS=side><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Regex Tools</TD></TR><TR><TD><A HREF="grep.html" TARGET=_top>grep</A></TD></TR><TR><TD><A HREF="powergrep.html" TARGET=_top>PowerGREP</A></TD></TR><TR><TD><A HREF="regexbuddy.html" TARGET=_top>RegexBuddy</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>General Applications</TD></TR><TR><TD><A HREF="editpadpro.html" TARGET=_top>EditPad&nbsp;Pro</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Languages &amp; Libraries</TD></TR><TR><TD><A HREF="delphi.html" TARGET=_top>Delphi</A></TD></TR><TR><TD><A HREF="java.html" TARGET=_top>Java</A></TD></TR><TR><TD><A HREF="javascript.html" TARGET=_top>JavaScript</A></TD></TR><TR><TD><A HREF="dotnet.html" TARGET=_top>.NET</A></TD></TR><TR><TD><A HREF="pcre.html" TARGET=_top>PCRE</A></TD></TR><TR><TD><A HREF="perl.html" TARGET=_top>Perl</A></TD></TR><TR><TD><A HREF="php.html" TARGET=_top>PHP</A></TD></TR><TR><TD><A HREF="python.html" TARGET=_top>Python</A></TD></TR><TR><TD><A HREF="ruby.html" TARGET=_top>Ruby</A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>More Information</TD></TR><TR><TD><A HREF="index-2.html" TARGET=_top>Introduction</A></TD></TR><TR><TD><A HREF="quickstart.html" TARGET=_top>Quick&nbsp;Start</A></TD></TR><TR><TD><A HREF="tutorial.html" TARGET=_top>Tutorial</A></TD></TR><TR><TD><A HREF="tools.html" TARGET=_top>Tools&nbsp;and&nbsp;Languages</A></TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="books.html" TARGET=_top>Books</A></TD></TR><TR><TD><A HREF="reference.html" TARGET=_top>Reference</A></TD></TR><TR><TD><A HREF="about.html" TARGET=_top>About&nbsp;This&nbsp;Site</A></TD></TR><TR><TD><A HREF="print.html" TARGET=_top>Download&nbsp;and&nbsp;Print</A></TD></TR></TABLE><iframe marginwidth="0" marginheight="0" width="160" height="600" scrolling="no" frameborder="0" src="http://rcm.amazon.com/e/cm?t=jgsbookselection&l=st1&search=vb.net&mode=books&p=14&o=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&lt1=_blank&nou&f=ifr"></iframe><P>&nbsp;</P> <TABLE CLASS=side CELLSPACING=0 CELLPADDING=4> <TR><TD CLASS=sideheader>PowerGREP 3</TD></TR> <TR><TD CLASS=ad><A HREF="http://www.powergrep.com/" TARGET=_top><IMG SRC="img/pgr.gif" WIDTH=32 HEIGHT=32 ALT="PowerGREP" ALIGN=LEFT CLASS=iconleft BORDER=0></A> <A HREF="http://www.powergrep.com/" TARGET=_top>PowerGREP</A> is probably the most powerful regex-based text processing tool available today. A knowledge worker's Swiss army knife for searching through, extracting information from, and updating piles of files.</TD></TR> <TR><TD CLASS=ad>Use regular expressions to search through large numbers of text and binary files, such as source code, correspondence, server or system logs, reference texts, archives, etc. Quickly find the files you are looking for, or extract the information you need. Look through just a handful of files, or thousands of files and folders.</TD></TR> <TR><TD CLASS=ad>Perform comprehensive text and binary replacement operations for easy maintenance of web sites, source code, reports, etc. Preview replacements before modifying files, and stay safe with flexible backup and undo options.</TD></TR> <TR><TD CLASS=ad>Work with plain text files, Unicode files, binary files, files stored in zip archives, and even MS Word documents, Excel spreadsheets and PDF files. Runs on Windows 98, ME, NT4, 2000 &amp; XP.</TD></TR> <TR><TD><A HREF="http://www.powergrep.com/" TARGET=_top>More information</A></TD></TR> <TR><TD><A HREF="http://www.powergrep.com/download.html" TARGET=_top>Download PowerGREP now</A></TD></TR> </TABLE></DIV></BODY>
<!-- Mirrored from www.regular-expressions.info/dotnet.html by HTTrack Website Copier/3.x [XR&CO'2002], Mon, 14 Nov 2005 11:48:07 GMT -->
</HTML>