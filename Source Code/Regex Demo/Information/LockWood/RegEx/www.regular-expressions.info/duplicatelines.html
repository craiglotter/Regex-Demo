<HTML>
<!-- Mirrored from www.regular-expressions.info/duplicatelines.html by HTTrack Website Copier/3.x [XR&CO'2002], Mon, 14 Nov 2005 11:49:59 GMT -->
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=ISO-8859-1">
<TITLE>Regexp Example: Deleting Duplicate Lines or Items with Regular Expressions</TITLE>

<META NAME="Author" CONTENT="Jan Goyvaerts">
<META NAME="Description" CONTENT="Detailed explanation of a simple regular expression that will delete duplicate lines from a file.  This example illustrates simple yet clever use of capturing parentheses or backreferences.">
<META NAME="Keywords" CONTENT="">
<LINK REL=StyleSheet HREF="regex.css" TYPE="text/css">
</HEAD>
<BODY BGCOLOR=white TEXT=black>
<DIV CLASS=top><DIV CLASS=logo><IMG SRC="img/logo.gif" WIDTH=530 HEIGHT=100></DIV></DIV>
<DIV CLASS=btntop><A CLASS=btntop HREF="tutorial.html" TARGET="_top">&nbsp;Tutorial&nbsp;</A><A CLASS=btntop HREF="tools.html" TARGET="_top">&nbsp;Tools&nbsp;&amp;&nbsp;Languages&nbsp;</A><A CLASS=btntop HREF="examples.html" TARGET="_top">&nbsp;Examples&nbsp;</A><A CLASS=btntop HREF="books.html" TARGET="_top">&nbsp;Books&nbsp;&amp;&nbsp;Reference&nbsp;</A></DIV>
<DIV CLASS=bodytext>
<H1>Deleting Duplicate Lines From a File</H1> <P>If you have a file in which all lines are sorted (alphabetically or otherwise), you can easily delete (subsequent) duplicate lines. Simply open the file in <A HREF="editpadpro.html" TARGET="_top">your favorite text editor</A>, and do a search-and-replace searching for <TT CLASS=regex>^(.*)(\r?\n\1)+$</TT> <RXB PAGE=duplicatelines"> and replacing with <TT CLASS=string>\1</TT>. For this to work, the <A HREF="anchors.html" TARGET="_top">anchors</A> need to match before and after line breaks (and not just at the start and the end of the file or string), and the <A HREF="dot.html" TARGET="_top">dot</A> must <EM>not</EM> match newlines.</P> <P>Here is how this works. The <A HREF="anchors.html" TARGET="_top">caret</A> will match only at the start of a line. So the regex engine will only attempt to match the remainder of the regex there. The <A HREF="dot.html" TARGET="_top">dot</A> and <A HREF="repeat.html" TARGET="_top">star</A> combination simply matches an entire line, whatever its contents, if any. The <A HREF="brackets.html" TARGET="_top">round brackets</A> store the matched line into the first backreference.</P> <P>Next we will match the line separator. I put the <A HREF="optional.html" TARGET="_top">question mark</A> into <TT CLASS=regex>\r?\n</TT> to make this regex work with both Windows (\r\n) and UNIX (\n) text files. So up to this point we matched a line and the following line break.</P> <P>Now we need to check if this combination is followed by a duplicate of that same line. We do this simply with <TT CLASS=regex>\1</TT>. This is the first backreference which holds the line we matched. The backreference will match that very same text.</P> <P>If the backreference fails to match, the regex match and the backreference are discarded, and the regex engine tries again at the start of the next line. If the backreference succeeds, the <A HREF="repeat.html" TARGET="_top">plus symbol</A> in the regular expression will try to match additional copies of the line. Finally, the dollar symbol forces the regex engine to check if the text matched by the backreference is a complete line. We already know the text matched by the backreference is preceded by a line break (matched by <TT CLASS=regex>\r?\n</TT>). Therefore, we now check if it is also followed by a line break or if it is at the end of the file using the <A HREF="anchors.html" TARGET="_top">dollar sign</A>.</P> <P>The entire match becomes <TT CLASS=match>line\nline</TT> (or <TT CLASS=match>line\nline\nline</TT> etc.). Because we are doing a search and replace, the line, its duplicates, and the line breaks in between them, are all deleted from the file. Since we want to keep the original line, but not the duplicates, we use <TT CLASS=string>\1</TT> as the replacement text to put the original line back in.</P> <H2>Removing Duplicate Items From a String</H2> <P>We can generalize the above example to <TT>afterseparator(item)(separator\1)+beforeseparator</TT>, where <TT>afterseparator</TT> and <TT>beforeseparator</TT> are zero-width. So if you want to remove subsequent duplicates from a comma-delimited list, you could use <TT CLASS=regex>(?&lt;=,|^)([^,]*)(,\1)+(?=,|$)</TT> <A HREF="regexbuddy/duplicatecsv.html"><IMG SRC="img/rxb.gif" WIDTH="16" HEIGHT="16" ALIGN=middle ALT="Analyze this regular expression with RegexBuddy" BORDER=0></A>.</P> <P>The <A HREF="lookaround.html" TARGET="_top">positive lookbehind</A> <TT CLASS=regex>(?&lt;=,|^)</TT> forces the regex engine to start matching at the start of the string or after a comma. <TT CLASS=regex>([^,]*)</TT> captures the item. <TT CLASS=regex>(,\1)+</TT> matches subsequent duplicate items. Finally, the <A HREF="lookaround.html" TARGET="_top">positive lookahead</A> <TT CLASS=regex>(?=,|$)</TT> checks if the duplicate items are complete items by checking for a comma or the end of the string.<DIV CLASS=copyright> <P CLASS=copyright>Page URL: <A HREF="duplicatelines.html" TARGET="_top">http://www.Regular-Expressions.info/duplicatelines.html</A><BR> Last Updated: 01 September 2004<BR> Copyright &copy; 2003-2005 Jan Goyvaerts. All rights reserved.</P> </DIV> </DIV> <DIV CLASS=side><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>Examples</TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="floatingpoint.html" TARGET=_top>Floating&nbsp;Point&nbsp;Numbers</A></TD></TR><TR><TD><A HREF="dates.html" TARGET=_top>Valid&nbsp;Dates</A></TD></TR><TR><TD><A HREF="completelines.html" TARGET=_top>Matching&nbsp;Complete&nbsp;Lines</A></TD></TR><TR><TD><A HREF="duplicatelines.html" TARGET=_top>Deleting&nbsp;Duplicate&nbsp;Lines</A></TD></TR><TR><TD><A HREF="examplesprogrammer.html" TARGET=_top>Programming</A></TD></TR><TR><TD><A HREF="near.html" TARGET=_top></A></TD></TR>
</TABLE><TABLE CLASS=side CELLSPACING=0 CELLPADDING=4><TR><TD CLASS=sideheader>More Information</TD></TR><TR><TD><A HREF="index-2.html" TARGET=_top>Introduction</A></TD></TR><TR><TD><A HREF="quickstart.html" TARGET=_top>Quick&nbsp;Start</A></TD></TR><TR><TD><A HREF="tutorial.html" TARGET=_top>Tutorial</A></TD></TR><TR><TD><A HREF="tools.html" TARGET=_top>Tools&nbsp;and&nbsp;Languages</A></TD></TR><TR><TD><A HREF="examples.html" TARGET=_top>Examples</A></TD></TR><TR><TD><A HREF="books.html" TARGET=_top>Books</A></TD></TR><TR><TD><A HREF="reference.html" TARGET=_top>Reference</A></TD></TR><TR><TD><A HREF="about.html" TARGET=_top>About&nbsp;This&nbsp;Site</A></TD></TR><TR><TD><A HREF="print.html" TARGET=_top>Download&nbsp;and&nbsp;Print</A></TD></TR></TABLE></DIV></BODY>
<!-- Mirrored from www.regular-expressions.info/duplicatelines.html by HTTrack Website Copier/3.x [XR&CO'2002], Mon, 14 Nov 2005 11:49:59 GMT -->
</HTML>